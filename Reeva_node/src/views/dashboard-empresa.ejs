<!DOCTYPE html>
<html lang="<%= userLang %>">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard Empresa</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { primary: '#B4447C' }
        }
      }
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css">
  <link rel="stylesheet" href="/css/header.css" />
</head>
<body class="font-sans min-h-screen flex flex-col">
  <%- include('header', { activePage: 'dashboard' }) %>
  <main class="container mx-auto px-4 py-6 md:py-10 space-y-6 md:space-y-10 max-w-7xl w-full">
    <% 
      const paramSel = typeof parametrizacionSelected !== 'undefined' ? parametrizacionSelected : {};
      const labelsSel = typeof parametrizacionLabelsSelected !== 'undefined' ? parametrizacionLabelsSelected : {};
      const nivel1 = paramSel?.nombreNivel1 || labelsSel?.nivel1Singular || 'Pasillo';
      const nivel1Plural = labelsSel?.nivel1Plural || (nivel1.endsWith('s') ? nivel1 : `${nivel1}s`);
      const nivel2 = paramSel?.nombreNivel2 || labelsSel?.nivel2Singular || 'Box';
      const nivel2Plural = labelsSel?.nivel2Plural || (nivel2.endsWith('s') ? nivel2 : `${nivel2}s`);
    %>

    <!-- Selector de empresa -->
    <section class="bg-white border rounded-2xl md:rounded-3xl shadow-sm p-4 md:p-6">
      <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
        <div>
          <p class="text-xs uppercase tracking-wide text-gray-500 mb-1">Empresa activa</p>
          <h1 class="text-xl md:text-2xl font-semibold text-gray-900">
            <%= selectedEmpresaNombre || 'Sin empresa seleccionada' %>
          </h1>
        </div>
        <% if ((empresasList || []).length > 1) { %>
        <div class="flex items-center gap-2 overflow-x-auto pb-1">
          <% empresasList.forEach(function(emp) { 
               const isActive = String(emp.empresaId) === String(selectedEmpresaId);
          %>
            <a href="/dashboard-empresa?empresaId=<%= emp.empresaId %>"
               class="px-4 py-2 rounded-full text-sm font-medium border transition-colors whitespace-nowrap <%= isActive ? 'bg-primary text-white border-primary' : 'bg-white text-gray-700 border-gray-200 hover:border-primary hover:text-primary' %>">
              <%= emp.nombre || emp.empresaId %>
            </a>
          <% }) %>
        </div>
        <% } %>
      </div>
    </section>

    <!-- KPIs simples -->
    <section class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-8">
      <article class="bg-white border rounded-2xl md:rounded-3xl p-6 md:p-10 shadow-sm">
        <div class="flex items-start justify-between gap-4">
          <div>
            <p class="text-xs md:text-sm text-gray-500">Total <%= nivel1Plural %></p>
            <p class="text-4xl md:text-6xl lg:text-7xl font-extrabold text-gray-900 leading-none mt-2"><%= totalPasillos %></p>
          </div>
          <div class="w-10 h-10 md:w-12 md:h-12 rounded-full bg-primary/10 text-primary flex items-center justify-center">
            <i class="ri-home-4-line md:ri-lg"></i>
          </div>
        </div>
      </article>
      <article class="bg-white border rounded-2xl md:rounded-3xl p-6 md:p-10 shadow-sm">
        <div class="flex items-start justify-between gap-4">
          <div>
            <p class="text-xs md:text-sm text-gray-500">Total <%= nivel2Plural %></p>
            <p class="text-4xl md:text-6xl lg:text-7xl font-extrabold text-gray-900 leading-none mt-2"><%= totalMesas %></p>
          </div>
          <div class="w-10 h-10 md:w-12 md:h-12 rounded-full bg-green-100 text-green-600 flex items-center justify-center">
            <i class="ri-checkbox-circle-line md:ri-lg"></i>
          </div>
        </div>
      </article>
    </section>
  </main>

  <%- include('footer') %>
</body>
</html>
